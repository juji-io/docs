<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>juji.func.nlp documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Juji Built-in Functions</span> <span class="project-version">2.1.35</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1"><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><a href="juji.func.data.html"><div class="inner"><span>juji.func.data</span></div></a></li><li class="depth-1 current"><a href="juji.func.nlp.html"><div class="inner"><span>juji.func.nlp</span></div></a></li><li class="depth-1"><a href="juji.func.system.html"><div class="inner"><span>juji.func.system</span></div></a></li><li class="depth-1"><a href="juji.func.user.html"><div class="inner"><span>juji.func.user</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="juji.func.nlp.html#var-complex-content.3F"><div class="inner"><span>complex-content?</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-contain-email"><div class="inner"><span>contain-email</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-contain-name.3F"><div class="inner"><span>contain-name?</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-contain-phone-number"><div class="inner"><span>contain-phone-number</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-contains-multiple-questions.3F"><div class="inner"><span>contains-multiple-questions?</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-contains-non-English.3F"><div class="inner"><span>contains-non-English?</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-extract-age"><div class="inner"><span>extract-age</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-extract-email"><div class="inner"><span>extract-email</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-extract-first-hobby"><div class="inner"><span>extract-first-hobby</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-extract-first-name"><div class="inner"><span>extract-first-name</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-extract-name"><div class="inner"><span>extract-name</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-extract-names"><div class="inner"><span>extract-names</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-extract-phone-number"><div class="inner"><span>extract-phone-number</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-extract-why-u-here"><div class="inner"><span>extract-why-u-here</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-get-email-domain"><div class="inner"><span>get-email-domain</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-get-possible-company-from-domain"><div class="inner"><span>get-possible-company-from-domain</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-get-top-ranked-faq-answer-from-index"><div class="inner"><span>get-top-ranked-faq-answer-from-index</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-get-top-ranked-qna-answer-info-from-index"><div class="inner"><span>get-top-ranked-qna-answer-info-from-index</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-get-top-ranked-qna-answer-text-from-index"><div class="inner"><span>get-top-ranked-qna-answer-text-from-index</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-has-adj-definition"><div class="inner"><span>has-adj-definition</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-has-negative-sentiment"><div class="inner"><span>has-negative-sentiment</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-has-noun-definition"><div class="inner"><span>has-noun-definition</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-has-positive-sentiment"><div class="inner"><span>has-positive-sentiment</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-has-verb-definition"><div class="inner"><span>has-verb-definition</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-ignore-case-equals.3F"><div class="inner"><span>ignore-case-equals?</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-informativeness"><div class="inner"><span>informativeness</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-is-gibberish"><div class="inner"><span>is-gibberish</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-is-name"><div class="inner"><span>is-name</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-is-name.3F"><div class="inner"><span>is-name?</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-is-similar-to-any"><div class="inner"><span>is-similar-to-any</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-lemmatize"><div class="inner"><span>lemmatize</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-list-extracted-hobby-info"><div class="inner"><span>list-extracted-hobby-info</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-max-similarity-score"><div class="inner"><span>max-similarity-score</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-non-trivial-noun-verb-extract-from-input"><div class="inner"><span>non-trivial-noun-verb-extract-from-input</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-present-qna-answer-in-context"><div class="inner"><span>present-qna-answer-in-context</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-present-qna-answer-text"><div class="inner"><span>present-qna-answer-text</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-similarity-exceeds-threshold"><div class="inner"><span>similarity-exceeds-threshold</span></div></a></li><li class="depth-1"><a href="juji.func.nlp.html#var-user-question.3F"><div class="inner"><span>user-question?</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">juji.func.nlp</h1><div class="doc"><div class="markdown"><p>Built-in functions that do natural language processing on user input</p></div></div><div class="public anchor" id="var-complex-content.3F"><h3>complex-content?</h3><div class="usage"><code>(complex-content? rep input)</code></div><div class="doc"><div class="markdown"><p>Check if <code>input</code> contains more than <code>:complex-content-threshold</code> number of clauses as set in <a href="https://juji.io/docs/reference/#config">script config</a>.</p>
<p><code>input</code> is a vector of tokens. This function is usually used with <a href="https://juji.io/docs/reference/#captured-content">captured content</a> in REP rules.</p></div></div></div><div class="public anchor" id="var-contain-email"><h3>contain-email</h3><div class="usage"><code>(contain-email rep)</code></div><div class="doc"><div class="markdown"><p>Check if the current user input contains a valid email.</p>
<p><strong>Example</strong></p>
<pre><code>;; use this function with `extract-email` as in the following rule
;; the rule first check if user input contains an email,
;; if it does, REP responds with a customized acknowledgement.
[(contain-email)]
[(str "Thank you. we have your email as" (extract-email) ".")
 (record-answer ?q (input-text))]
</code></pre></div></div></div><div class="public anchor" id="var-contain-name.3F"><h3>contain-name?</h3><div class="usage"><code>(contain-name? rep)</code><code>(contain-name? _ tokens)</code></div><div class="doc"><div class="markdown"><p>Check if the current user input contains at least one person’s name. Check the given vector of tokens contains at least one person’s name if a vector is passed in.</p></div></div></div><div class="public anchor" id="var-contain-phone-number"><h3>contain-phone-number</h3><div class="usage"><code>(contain-phone-number rep)</code></div><div class="doc"><div class="markdown"><p>Check if the current user input contains a valid US phone number.</p>
<p><strong>Example</strong></p>
<pre><code>;; use this function with `extract-phone-number` as in the following rule
;; the rule first check if user input contains an phone number,
;; if it does, REP responds with a customized acknowledgement.
[(contain-phone-number)]
[(str "Thank you. we have your phone number as" (extract-phone-number) ".")
 (record-answer ?q (input-text))]
</code></pre></div></div></div><div class="public anchor" id="var-contains-multiple-questions.3F"><h3>contains-multiple-questions?</h3><div class="usage"><code>(contains-multiple-questions? _ input)</code></div><div class="doc"><div class="markdown"><p>Returns true iff the given <code>input</code> has more than one question.</p>
<p><code>input</code> needs to contain at least 2 sentences for this to be true.</p>
<p><code>input</code> is a vector of tokens. This function is usually used with <a href="https://juji.io/docs/reference/#captured-content">captured content</a> in REP rules.</p></div></div></div><div class="public anchor" id="var-contains-non-English.3F"><h3>contains-non-English?</h3><div class="usage"><code>(contains-non-English? _ input)</code></div><div class="doc"><div class="markdown"><p>Checks if there are non-English words in the given <code>input</code>.</p>
<p><code>input</code> is a vector of tokens. This function is usually used with <a href="https://juji.io/docs/reference/#captured-content">captured content</a> in REP rules.</p>
<p><strong>Example</strong></p>
<pre><code>;; The trigger below would fire if the words captured in ?something contains non-English
[I like to read (?something +) (contains-non-English? ?something)]
</code></pre></div></div></div><div class="public anchor" id="var-extract-age"><h3>extract-age</h3><div class="usage"><code>(extract-age rep)</code></div><div class="doc"><div class="markdown"><p>Extract age from the current user input.</p></div></div></div><div class="public anchor" id="var-extract-email"><h3>extract-email</h3><div class="usage"><code>(extract-email rep)</code><code>(extract-email _ text)</code></div><div class="doc"><div class="markdown"><p>Extract email from the current user input. Return nil if there’s no valid email found.</p></div></div></div><div class="public anchor" id="var-extract-first-hobby"><h3>extract-first-hobby</h3><div class="usage"><code>(extract-first-hobby rep)</code></div><div class="doc"><div class="markdown"><p>Extract the first hobby from the current user input. If the input has no activity, return nil.</p></div></div></div><div class="public anchor" id="var-extract-first-name"><h3>extract-first-name</h3><div class="usage"><code>(extract-first-name rep)</code></div><div class="doc"><div class="markdown"><p>Extract the first name from the current user input. Assume the format “first middle last”.</p></div></div></div><div class="public anchor" id="var-extract-name"><h3>extract-name</h3><div class="usage"><code>(extract-name rep)</code></div><div class="doc"><div class="markdown"><p>Extract name from the current rep input.</p></div></div></div><div class="public anchor" id="var-extract-names"><h3>extract-names</h3><div class="usage"><code>(extract-names rep)</code></div><div class="doc"><div class="markdown"><p>Extract people’s names in the current user input. Returns nil if there’s no name, otherwise return a list of strings - each string is a name extracted.</p></div></div></div><div class="public anchor" id="var-extract-phone-number"><h3>extract-phone-number</h3><div class="usage"><code>(extract-phone-number rep)</code></div><div class="doc"><div class="markdown"><p>Extract phone number from the current user input. Return nil if there’s no valid US phone number found.</p></div></div></div><div class="public anchor" id="var-extract-why-u-here"><h3>extract-why-u-here</h3><div class="usage"><code>(extract-why-u-here rep)</code></div><div class="doc"><div class="markdown"><p>Extract information from the current user input. Assume it answers the greeting question regarding visitor’s objective e.g., “what brings you here?”</p></div></div></div><div class="public anchor" id="var-get-email-domain"><h3>get-email-domain</h3><div class="usage"><code>(get-email-domain _ email-text)</code></div><div class="doc"><div class="markdown"><p>Get given email’s domain.</p></div></div></div><div class="public anchor" id="var-get-possible-company-from-domain"><h3>get-possible-company-from-domain</h3><div class="usage"><code>(get-possible-company-from-domain _ email-text)</code></div><div class="doc"><div class="markdown"><p>Make educated guess about the name of the comapny the given email is affiliated with.</p></div></div></div><div class="public anchor" id="var-get-top-ranked-faq-answer-from-index"><h3>get-top-ranked-faq-answer-from-index</h3><h4 class="deprecated">deprecated</h4><div class="usage"><code>(get-top-ranked-faq-answer-from-index rep index-id)</code><code>(get-top-ranked-faq-answer-from-index rep index-id threshold)</code></div><div class="doc"><div class="markdown"><p>Return the most relevent answer to the current user input from the given FAQ index. When <code>threshold</code> is not provided, assume it to be 0.85. When relevance score of the top answer is less than <code>threshold</code>, return nil.</p></div></div></div><div class="public anchor" id="var-get-top-ranked-qna-answer-info-from-index"><h3>get-top-ranked-qna-answer-info-from-index</h3><div class="usage"><code>(get-top-ranked-qna-answer-info-from-index rep index-id)</code><code>(get-top-ranked-qna-answer-info-from-index rep index-id threshold)</code></div><div class="doc"><div class="markdown"><p>Return the most relevent answer info to the current user input from the given FAQ index. When <code>threshold</code> is not provided, assume it to be 0.85. When relevance score of the top answer is less than <code>threshold</code>, return nil.</p></div></div></div><div class="public anchor" id="var-get-top-ranked-qna-answer-text-from-index"><h3>get-top-ranked-qna-answer-text-from-index</h3><div class="usage"><code>(get-top-ranked-qna-answer-text-from-index rep index-id)</code><code>(get-top-ranked-qna-answer-text-from-index rep index-id threshold)</code></div><div class="doc"><div class="markdown"><p>Return the most relevent answer text to the current user input from the given FAQ index. When <code>threshold</code> is not provided, assume it to be 0.85. When relevance score of the top answer is less than <code>threshold</code>, return nil.</p></div></div></div><div class="public anchor" id="var-has-adj-definition"><h3>has-adj-definition</h3><div class="usage"><code>(has-adj-definition _ word)</code></div><div class="doc"><div class="markdown"><p>Check whether the given <code>word</code> or phrase has an adjective definition.</p>
<p><code>word</code> is a string or a vector of strings. However, when it is a vector, only the first item of the vector will be used.</p></div></div></div><div class="public anchor" id="var-has-negative-sentiment"><h3>has-negative-sentiment</h3><div class="usage"><code>(has-negative-sentiment rep)</code></div><div class="doc"><div class="markdown"><p>Check if current user input has negative sentiment.</p></div></div></div><div class="public anchor" id="var-has-noun-definition"><h3>has-noun-definition</h3><div class="usage"><code>(has-noun-definition _ word)</code></div><div class="doc"><div class="markdown"><p>Check whether the given <code>word</code> or phrase has a noun definition.</p>
<p><code>word</code> is a string or a vector of strings. However, when it is a vector, only the first item of the vector will be used.</p></div></div></div><div class="public anchor" id="var-has-positive-sentiment"><h3>has-positive-sentiment</h3><div class="usage"><code>(has-positive-sentiment rep)</code></div><div class="doc"><div class="markdown"><p>Check if current user input has positive sentiment.</p></div></div></div><div class="public anchor" id="var-has-verb-definition"><h3>has-verb-definition</h3><div class="usage"><code>(has-verb-definition _ word)</code></div><div class="doc"><div class="markdown"><p>Check whether the given <code>word</code> or phrase has a verb definition.</p>
<p><code>word</code> is a string or a vector of strings. However, when it is a vector, only the first item of the vector will be used.</p></div></div></div><div class="public anchor" id="var-ignore-case-equals.3F"><h3>ignore-case-equals?</h3><div class="usage"><code>(ignore-case-equals? rep phrase1 phrase2)</code></div><div class="doc"><div class="markdown"><p>Check if two phrases are equal if case is ignored.</p></div></div></div><div class="public anchor" id="var-informativeness"><h3>informativeness</h3><div class="usage"><code>(informativeness _ input)</code></div><div class="doc"><div class="markdown"><p>Calculate informativeness of the given <code>input</code> in term of <a href="https://en.wikipedia.org/wiki/Information_content">surprisal</a></p>
<p><code>input</code> is a vector of tokens. This function is usually used with <a href="https://juji.io/docs/reference/#captured-content">captured content</a> in REP rules. </p></div></div></div><div class="public anchor" id="var-is-gibberish"><h3>is-gibberish</h3><div class="usage"><code>(is-gibberish rep)</code></div><div class="doc"><div class="markdown"><p>Check if the current user input is considered gibberish (in English).</p></div></div></div><div class="public anchor" id="var-is-name"><h3>is-name</h3><h4 class="deprecated">deprecated</h4><div class="usage"><code>(is-name _ input)</code></div><div class="doc"><div class="markdown"><p>Check the given <code>input</code> is a name.</p>
<p><code>input</code> is a vector of tokens. This function is usually used with <a href="https://juji.io/docs/reference/#captured-content">captured content</a> in REP rules.</p>
<p><strong>Example</strong></p>
<pre><code>;; The trigger below would fire if the words captured in ?someone is a person's name
[I like to play with (?someone +) (is-name ?someone)]
</code></pre></div></div></div><div class="public anchor" id="var-is-name.3F"><h3>is-name?</h3><div class="usage"><code>(is-name? _ input)</code></div><div class="doc"><div class="markdown"><p>Check the given <code>input</code> is a name. This is more strict than the deprecated function <code>is-name</code></p>
<p><code>input</code> is a vector of tokens. This function is usually used with <a href="https://juji.io/docs/reference/#captured-content">captured content</a> in REP rules.</p>
<p><strong>Example</strong></p>
<pre><code>;; The trigger below would fire if the words captured in ?someone is a person's name
[I like to play with (?someone +) (is-name? ?someone)]
</code></pre></div></div></div><div class="public anchor" id="var-is-similar-to-any"><h3>is-similar-to-any</h3><h4 class="deprecated">deprecated</h4><div class="usage"></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-lemmatize"><h3>lemmatize</h3><div class="usage"><code>(lemmatize _ s)</code></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-list-extracted-hobby-info"><h3>list-extracted-hobby-info</h3><div class="usage"><code>(list-extracted-hobby-info rep)</code></div><div class="doc"><div class="markdown"><p>Extract and list hobby info separated by comma from the current user input.</p></div></div></div><div class="public anchor" id="var-max-similarity-score"><h3>max-similarity-score</h3><div class="usage"><code>(max-similarity-score rep anchors)</code></div><div class="doc"><div class="markdown"><p>Calculate the sentence similarity of user input against the <code>anchors</code>, and return the highest similarity score. The function returns 0 if there’s an exception.</p>
<p><code>anchors</code> is a vector of sentence strings.</p>
<p><strong>Example</strong></p>
<pre><code>;; say user input is "My favorite is Diablo"
;; the following rule will trigger, because the max-similarity-score function returns 0.85
;; thus the inequality will return true
[(&gt; (max-similarity-score ["I like Diablo the most." "I usually play Diablo."]) 0.8)]
</code></pre></div></div></div><div class="public anchor" id="var-non-trivial-noun-verb-extract-from-input"><h3>non-trivial-noun-verb-extract-from-input</h3><div class="usage"><code>(non-trivial-noun-verb-extract-from-input rep)</code></div><div class="doc"><div class="markdown"><p>Extract non-trivial nouns and verbs from the current user input. Return a vector containing the extracted tokens.</p>
<p><strong>Example</strong></p>
<pre><code>;; say the current user input is "He likes to play basketball."
;; the following pattern stores `["likes" "play" "basketball"]` in variable `?extracted`
[(&lt;- ?extracted (non-trivial-noun-verb-extract))]
</code></pre></div></div></div><div class="public anchor" id="var-present-qna-answer-in-context"><h3>present-qna-answer-in-context</h3><div class="usage"><code>(present-qna-answer-in-context rep matched-qna)</code><code>(present-qna-answer-in-context rep matched-qna in-context-response)</code></div><div class="doc"><div class="markdown"><p>Present Q&amp;A answer consider the current context. If the Q&amp;A is the same as the ones in the current mini-agenda entrance context and in-context-response is supplied, in-context-response is used instead of the qna answer..</p></div></div></div><div class="public anchor" id="var-present-qna-answer-text"><h3>present-qna-answer-text</h3><div class="usage"><code>(present-qna-answer-text rep qna-answer-text)</code></div><div class="doc"><div class="markdown"><p>Present Q&amp;A answer text. This also show the multi step Q&amp;A topics.</p></div></div></div><div class="public anchor" id="var-similarity-exceeds-threshold"><h3>similarity-exceeds-threshold</h3><div class="usage"><code>(similarity-exceeds-threshold rep anchors)</code><code>(similarity-exceeds-threshold rep anchors threshold)</code></div><div class="doc"><div class="markdown"><p>Return true if the user input is similar to any of the <code>anchors</code>; return false otherwise.</p>
<p>This is a wrapper for thresholding <code>max-similarity-score</code>. If <code>threshold</code> is provided, the function returns true if <code>(max-similarity-score anchors)</code> is greater than the <code>threshold</code>; otherwise, 0.8 is used as <code>threshold</code>.</p></div></div></div><div class="public anchor" id="var-user-question.3F"><h3>user-question?</h3><div class="usage"><code>(user-question? rep)</code><code>(user-question? _ tokens)</code></div><div class="doc"><div class="markdown"><p>Check if current user input or the given tokens contains a question.</p></div></div></div></div></body></html>